"use strict";(()=>{var e={};e.id=5457,e.ids=[5457],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},73292:e=>{e.exports=require("fs/promises")},41808:e=>{e.exports=require("net")},71017:e=>{e.exports=require("path")},77282:e=>{e.exports=require("process")},12781:e=>{e.exports=require("stream")},71576:e=>{e.exports=require("string_decoder")},39512:e=>{e.exports=require("timers")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},22910:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>j,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>x,serverHooks:()=>q,staticGenerationAsyncStorage:()=>g});var r={};t.r(r),t.d(r,{DELETE:()=>m,GET:()=>l,POST:()=>c});var a=t(49303),i=t(88716),o=t(60670),n=t(87070),u=t(73292),p=t(71017),d=t(8852);async function l(){try{let e=await d.uu.getMediaFiles();return n.NextResponse.json({success:!0,data:e})}catch(e){return n.NextResponse.json({success:!1,message:"Failed to fetch media"},{status:500})}}async function c(e){try{let s=await e.formData(),t=s.get("file");if(!t)return n.NextResponse.json({success:!1,message:"No file provided"},{status:400});let r=(0,p.join)(process.cwd(),"public","media");try{await (0,u.mkdir)(r,{recursive:!0})}catch(e){}let a=[".jpg",".jpeg",".png",".gif",".webp",".svg",".mp4",".webm",".mov",".avi",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".txt",".zip",".rar"],i=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!a.includes(i))return n.NextResponse.json({success:!1,message:`File type ${i} not supported. Allowed types: ${a.join(", ")}`},{status:400});if(t.size>52428800)return n.NextResponse.json({success:!1,message:"File size too large. Maximum size is 50MB"},{status:400});let o=Date.now(),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),c=`${o}-${l}`,m=(0,p.join)(r,c),x=await t.arrayBuffer(),f=Buffer.from(x);await (0,u.writeFile)(m,f);let g=s.get("alt_text")||t.name,q=parseInt(s.get("uploaded_by"))||1,j={filename:l,original_name:t.name,file_path:`/media/${c}`,file_size:t.size,mime_type:t.type,alt_text:g,uploaded_by:q},y=await d.uu.createMediaFile(j);return n.NextResponse.json({success:!0,data:y,message:"File uploaded successfully"},{status:201})}catch(e){return n.NextResponse.json({success:!1,message:"Failed to upload file"},{status:500})}}async function m(e){try{let{searchParams:s}=new URL(e.url),t=s.get("id");if(!t)return n.NextResponse.json({success:!1,message:"Media ID is required"},{status:400});if(!await d.uu.deleteMediaFile(parseInt(t)))return n.NextResponse.json({success:!1,message:"Media file not found"},{status:404});return n.NextResponse.json({success:!0,message:"Media file deleted successfully"})}catch(e){return n.NextResponse.json({success:!1,message:"Failed to delete media file"},{status:500})}}let x=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/media/route",pathname:"/api/admin/media",filename:"route",bundlePath:"app/api/admin/media/route"},resolvedPagePath:"C:\\Users\\Berlin\\Desktop\\sssq-main\\sssq-main\\app\\api\\admin\\media\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:q}=x,j="/api/admin/media/route";function y(){return(0,o.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:g})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[8948,5972,3785,5802],()=>t(22910));module.exports=r})();